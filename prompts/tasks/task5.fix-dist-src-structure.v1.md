# Task 5: dist/srcæ§‹é€ ã®è§£æ¶ˆ

> **ğŸ”’ ã“ã®æ–‡ç« ã¯FIXEDã§ã™ (2025-11-04)**
> ä»¥é™ã®ä¿®æ­£ã¯æ³¨é‡ˆè¿½è¨˜ã®ã¿è¨±å¯ã•ã‚Œã¾ã™

## å•é¡Œ

cliãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã ã‘ãŒ `dist/src/` ã¨ã„ã†å†—é•·ãªæ§‹é€ ã«ãªã£ã¦ã„ã‚‹ã€‚

### ç¾çŠ¶åˆ†æ

**ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ **:
```
packages/cli/
â”œâ”€â”€ bin/
â”‚   â””â”€â”€ search-docs.ts  # å˜ã« ../src/index.js ã‚’import
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts
â”‚   â””â”€â”€ commands/...
â””â”€â”€ dist/
    â”œâ”€â”€ bin/
    â”‚   â””â”€â”€ search-docs.js
    â””â”€â”€ src/           # â† å†—é•·
        â”œâ”€â”€ index.js
        â””â”€â”€ commands/...
```

**åŸå› **:
```json
// tsconfig.json
{
  "rootDir": ".",
  "include": ["src/**/*", "bin/**/*"]
}
```

**ä¾å­˜ç®‡æ‰€**:
- `src/index.ts`: `__dirname` ã‹ã‚‰ `../../package.json`
- `src/commands/server/start.ts`: `__dirname` ã‹ã‚‰ `../../../../package.json`

**bin/ã®å­˜åœ¨æ„ç¾©**: ãªã—
- `bin/search-docs.ts` ã¯å˜ã« `../src/index.js` ã‚’importã™ã‚‹ã ã‘
- serverãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®bin/ã¯å®Ÿéš›ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’å«ã‚€ã®ã§å¿…è¦ã ãŒã€cliã¯ä¸è¦

## ä½œæ¥­è¨ˆç”»

### 1. bin/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å‰Šé™¤
- [x] bin/search-docs.ts ã®å‰Šé™¤

### 2. src/index.ts ã®ä¿®æ­£
- [x] shebang `#!/usr/bin/env node` ã®è¿½åŠ 
- [x] __dirname ç›¸å¯¾ãƒ‘ã‚¹ã®ä¿®æ­£ï¼ˆ`../../` â†’ `../`ï¼‰

### 3. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿®æ­£
- [x] package.json ã® bin ã‚’ `dist/index.js` ã«å¤‰æ›´
- [x] package.json ã® dev ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ `tsx src/index.ts` ã«å¤‰æ›´
- [x] tsconfig.json ã‚’ä¿®æ­£:
  - rootDir: "src"
  - include: ["src/**/*"]

### 4. start.ts ã®ä¿®æ­£
- [x] __dirname ç›¸å¯¾ãƒ‘ã‚¹ã®ä¿®æ­£ï¼ˆ`../../../../` â†’ `../../`ï¼‰

### 5. ãƒ“ãƒ«ãƒ‰ã¨å‹•ä½œç¢ºèª
- [x] distã‚¯ãƒªãƒ¼ãƒ³
- [x] ãƒ“ãƒ«ãƒ‰å®Ÿè¡Œ
- [x] dist/ã®æ§‹é€ ç¢ºèª
- [x] E2Eãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

### 6. ã‚³ãƒŸãƒƒãƒˆ
- [x] å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆ

## æœŸå¾…ã•ã‚Œã‚‹çµæœ

```
packages/cli/dist/
â”œâ”€â”€ index.js         # CLI ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ
â”œâ”€â”€ commands/
â”‚   â””â”€â”€ server/
â”‚       â”œâ”€â”€ start.js
â”‚       â”œâ”€â”€ stop.js
â”‚       â”œâ”€â”€ restart.js
â”‚       â””â”€â”€ status.js
â””â”€â”€ utils/
    â”œâ”€â”€ pid.js
    â”œâ”€â”€ process.js
    â””â”€â”€ project.js
```

## å®Œäº†ã‚µãƒãƒªãƒ¼

### å®Ÿæ–½å†…å®¹

1. **bin/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å‰Šé™¤**
   - `bin/search-docs.ts` ã‚’å‰Šé™¤ï¼ˆå˜ãªã‚‹reexportã§ä¸è¦ï¼‰

2. **src/index.tsã®ä¿®æ­£**
   - shebang `#!/usr/bin/env node` ã‚’è¿½åŠ 
   - __dirnameç›¸å¯¾ãƒ‘ã‚¹: `../../package.json` â†’ `../package.json`

3. **è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿®æ­£**
   - package.json: bin ã‚’ `./dist/index.js` ã«å¤‰æ›´
   - package.json: dev ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ `tsx src/index.ts` ã«å¤‰æ›´
   - tsconfig.json: `rootDir: "src"`, `include: ["src/**/*"]`

4. **start.tsã®ä¿®æ­£**
   - fallback __dirnameç›¸å¯¾ãƒ‘ã‚¹: `../../../../package.json` â†’ `../../../package.json`

5. **E2Eãƒ†ã‚¹ãƒˆã®ä¿®æ­£**
   - ãƒ†ã‚¹ãƒˆå†…ã®ãƒ‘ã‚¹å‚ç…§: `../dist/bin/search-docs.js` â†’ `../dist/index.js`

### çµæœ

**å¤‰æ›´å‰**:
```
dist/
â”œâ”€â”€ bin/
â”‚   â””â”€â”€ search-docs.js
â””â”€â”€ src/              # å†—é•·
    â”œâ”€â”€ index.js
    â”œâ”€â”€ commands/
    â””â”€â”€ utils/
```

**å¤‰æ›´å¾Œ**:
```
dist/
â”œâ”€â”€ index.js         # CLIã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ
â”œâ”€â”€ commands/
â”‚   â””â”€â”€ server/
â””â”€â”€ utils/
```

**ãƒ†ã‚¹ãƒˆçµæœ**: 5/5 E2Eãƒ†ã‚¹ãƒˆåˆæ ¼ âœ…

**ã‚³ãƒŸãƒƒãƒˆ**: d20d93f

### åŠ¹æœ

- âœ… dist/src/ã¨ã„ã†å†—é•·ãªæ§‹é€ ã‚’è§£æ¶ˆ
- âœ… ãƒ¢ãƒãƒ¬ãƒå†…ã§ä¸€è²«ã—ãŸæ§‹é€ ï¼ˆä»–ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨åŒæ§˜ã«dist/ç›´ä¸‹ã«å‡ºåŠ›ï¼‰
- âœ… __dirnameç›¸å¯¾ãƒ‘ã‚¹ãŒæ­£ã—ãå‹•ä½œ
- âœ… bin/ã¨ã„ã†ä¸è¦ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å‰Šé™¤

## å°†æ¥ã®èª²é¡Œ

ãªã—
